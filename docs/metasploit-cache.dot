digraph "metasploit-cache" {
  graph [
    rankdir = "LR"
    ranksep = "20.0"
  ]
  node [
    shape = "record"
  ]

  subgraph cluster_common {
    label = "Common and Unchanged"

    "Metasploit::Cache::Module::Rank" [
      label = "Metasploit::Cache::Module::Rank | mc_module_ranks | <id>id | name | number"
    ]
  }

  subgraph cluster_before {
    label = "Before"

    "Before/Metasploit::Cache::Module::Ancestor" [
      label = "Metasploit::Cache::Module::Ancestor | mc_module_ancestors | full_name | module_type | parent_path_id | payload_type | reference_name | real_path | real_path_modified_at | real_path_sha1_hex_digest"
    ]

    "Before/Metasploit::Cache::Module::Class" [
      label = "Metasploit::Cache::Module::Class | mc_module_classes | <id>id | full_name | module_type | payload_type | <rank_id>rank_id | reference_name"
    ]

    "Before/Metasploit::Cache::Module::Class":rank_id -> "Metasploit::Cache::Module::Rank":id [
      headlabel = "has_many :module_classes"
      taillabel = "belongs_to :rank"
    ]

    "Before/Metasploit::Cache::Module::Instance" [
       label = "Metasploit::Cache::Module::Instance | mc_module_instances | <id>id | <default_action_id>default_action_id | default_target_id | description | disclosed_on | license | <module_class_id>module_class_id | name | privileged | stance"
    ]

    "Before/Metasploit::Cache::Module::Instance":module_class_id -> "Before/Metasploit::Cache::Module::Class":id [
      headlabel = "has_one :module_instance"
      taillabel = "belongs_to :module_class"
    ]

    "Before/Metasploit::Cache::Module::Action" [
      label = "Metasploit::Cache::Module::Action | mc_module_actions | <id>id | <module_instance_id>module_instance_id | name"
    ]

    "Before/Metasploit::Cache::Module::Instance":default_action_id -> "Before/Metasploit::Cache::Module::Action":id [
      taillabel = "belongs_to :default_action"
    ]

    "Before/Metasploit::Cache::Module::Action":module_instance_id -> "Before/Metasploit::Cache::Module::Instance":id [
      headlabel = "has_many :actions"
      taillabel = "belongs_to :module_instance"
    ]
  }

  subgraph cluster_type_sti {
    label = "module_type + payload_type STI"

    "Metasploit::Cache::Auxiliary::Action" [
      label = "Metasploit::Cache::Auxiliary::Action | mc_auxiliary_actions | <id>id | <auxiliary_instance_id>auxiliary_instance_id | name"
    ]

    "Metasploit::Cache::Auxiliary::Action":auxiliary_instance_id -> "Metasploit::Cache::Auxiliary::Instance":id [
      headlabel = "has_many :auxiliary_actions,\nclass_name: 'Metasploit::Cache::Auxiliary::Action'"
      taillabel = "belongs_to :auxiliary_instance,\nclass_name: 'Metasploit::Cache::Auxiliary::Instance'"
    ]

    subgraph cluster_mc_module_ancestors {
      label = "Metasploit::Cache::Module::Ancestor STI"

      "Metasploit::Cache::Module::Ancestor" [
        label = "Metasploit::Cache::Module::Ancestor | mc_module_ancestors | id | parent_path_id | relative_path | real_path_modified_at | real_path_sha1_hex_digest | type = 'Metasploit::Cache::Auxiliary::Ancestor'"
        style = "dashed"
      ]

      "Metasploit::Cache::Auxiliary::Ancestor" [
        label = "Metasploit::Cache::Auxiliary::Ancestor | <id>id | type = 'Metasploit::Cache::Auxiliary::Ancestor'"
      ]

      "Metasploit::Cache::Auxiliary::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]

      "Metasploit::Cache::Encoder::Ancestor" [
        label = "Metasploit::Cache::Encoder::Ancestor | <id>id | type = 'Metasploit::Cache::Encoder::Ancestor'"
      ]

      "Metasploit::Cache::Encoder::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]

      "Metasploit::Cache::Exploit::Ancestor" [
        label = "Metasploit::Cache::Exploit::Ancestor | <id>id | type = 'Metasploit::Cache::Exploit::Ancestor"
      ]

      "Metasploit::Cache::Exploit::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]

      "Metasploit::Cache::Nop::Ancestor" [
        label = "Metasploit::Cache::Nop::Ancestor | <id>id | type = 'Metasploit::Cache::Nop::Ancestor'"
      ]

      "Metasploit::Cache::Nop::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]

      "Metasploit::Cache::Payload::Single::Ancestor" [
        label = "Metasploit::Cache::Payload::Single::Ancestor | <id>id | type = 'Metasploit::Cache::Payload::Single::Ancestor'"
      ]

      "Metasploit::Cache::Payload::Single::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]
      
      "Metasploit::Cache::Payload::Stage::Ancestor" [
        label = "Metasploit::Cache::Payload::Stage::Ancestor | <id>id | type = 'Metasploit::Cache::Payload::Stage::Ancestor'"
      ]

      "Metasploit::Cache::Payload::Stage::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]
      
      "Metasploit::Cache::Payload::Stager::Ancestor" [
        label = "Metasploit::Cache::Payload::Stager::Ancestor | <id>id | type = 'Metasploit::Cache::Payload::Stager::Ancestor'"
      ]

      "Metasploit::Cache::Payload::Stager::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]
      
      "Metasploit::Cache::Post::Ancestor" [
        label = "Metasploit::Cache::Post::Ancestor | <id>id | type = 'Metasploit::Cache::Post::Ancestor'"
      ]

      "Metasploit::Cache::Post::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]
    }

    subgraph cluster_metasploit_cache_class {
      label = "Metasploit::Cache::*::Class"

      subgraph cluster_metasploit_cache_direct_class {
        label = "Metasploit::Cache::Direct::Class STI"

        "Metasploit::Cache::Direct::Class" [
          label = "Metasploit::Cache::Direct::Class | mc_direct_classes | <ancestor_id>ancestor_id | <rank_id>rank_id | type = 'Metasploit::Cache::Direct::Class'"
          style = "dashed"
        ]

        "Metasploit::Cache::Direct::Class":rank_id -> "Metasploit::Cache::Module::Rank":id [
          taillabel = "belongs_to :rank"
        ]

        "Metasploit::Cache::Auxiliary::Class" [
          label = "Metasploit::Cache::Auxiliary::Class | <id>id | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Auxiliary::Class'"
        ]

        "Metasploit::Cache::Auxiliary::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Auxiliary::Class":ancestor_id -> "Metasploit::Cache::Auxiliary::Ancestor":id [
          headlabel = "has_one :auxiliary_class,\nclass_name: 'Metasploit::Cache::Auxiliary::Class'"
          taillabel = "belongs_to :auxiliary_ancestor,\nclass_name: 'Metasploit::Cache::Auxiliary::Ancestor'"
        ]
        
        "Metasploit::Cache::Encoder::Class" [
          label = "Metasploit::Cache::Encoder::Class | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Encoder::Class'"
        ]

        "Metasploit::Cache::Encoder::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Encoder::Class":ancestor_id -> "Metasploit::Cache::Encoder::Ancestor":id [
          headlabel = "has_one :encoder_class,\nclass_name: 'Metasploit::Cache::Encoder::Class'"
          taillabel = "belongs_to :encoder_ancestor,\nclass_name: 'Metasploit::Cache::Encoder::Ancestor'"
        ]
                
        "Metasploit::Cache::Exploit::Class" [
          label = "Metasploit::Cache::Exploit::Class | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Exploit::Class'"
        ]

        "Metasploit::Cache::Exploit::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Exploit::Class":ancestor_id -> "Metasploit::Cache::Exploit::Ancestor":id [
          headlabel = "has_one :exploit_class,\nclass_name: 'Metasploit::Cache::Module::Exploit'"
          taillabel = "belongs_to :exploit_ancestor,\nclass_name: 'Metasploit::Cache::Exploit::Ancestor'"
        ]
        
        "Metasploit::Cache::Nop::Class" [
          label = "Metasploit::Cache::Nop::Class | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Nop::Class'"
        ]

        "Metasploit::Cache::Nop::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Nop::Class":ancestor_id -> "Metasploit::Cache::Nop::Ancestor":id [
          headlabel = "has_one :nop_class,\nclass_name: 'Metasploit::Cache::Nop::Class'"
          taillabel = "belongs_to :nop_ancestor,\nclass_name: 'Metasploit::Cache::Nop::Ancestor'"
        ]
        
        "Metasploit::Cache::Payload::Single::Class" [
          label = "Metasploit::Cache::Payload::Single::Class | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Payload::Single::Class'"
        ]

        "Metasploit::Cache::Payload::Single::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Payload::Single::Class":ancestor_id -> "Metasploit::Cache::Payload::Single::Ancestor":id [
          headlabel = "has_one :single_payload_class,\nclass_name: 'Metasploit::Cache::Payload::Single::Class'"
          taillabel = "belongs_to :single_payload_ancestor,\nclass_name: 'Metasploit::Cache::Payload::Single::Ancestor'"
        ]
        
        "Metasploit::Cache::Payload::Stage::Class" [
          label = "Metasploit::Cache::Payload::Stage::Class | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Payload::Stage::Class'"
        ]

        "Metasploit::Cache::Payload::Stage::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Payload::Stage::Class":ancestor_id -> "Metasploit::Cache::Payload::Stage::Ancestor":id [
          headlabel = "has_one :stage_payload_class,\nclass_name: 'Metasploit::Cache::Payload::Stage::Ancestor'"
          taillabel = "belongs_to :stage_payload_ancestor,\nclass_name: 'Metasploit::Cache::Payload::Stage::Ancestor'"
        ]
        
                
        "Metasploit::Cache::Payload::Stager::Class" [
          label = "Metasploit::Cache::Payload::Stager::Class | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Payload::Stager::Class'"
        ]

        "Metasploit::Cache::Payload::Stager::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Payload::Stager::Class":ancestor_id -> "Metasploit::Cache::Payload::Stager::Ancestor":id [
          headlabel = "has_one :stager_payload_class\nclass_name: 'Metasploit::Cache::Payload::Stager::Class'"
          taillabel = "belongs_to :ancestor,\nclass_name: 'Metasploit::Cache::Payload::Stager::Ancestor'"
        ]
        
        "Metasploit::Cache::Post::Class" [
          label = "Metasploit::Cache::Post::Class | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Post::Class'"
        ]

        "Metasploit::Cache::Post::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Post::Class":ancestor_id -> "Metasploit::Cache::Post::Ancestor":id [
          headlabel = "has_one :post_class,\nclass_name: 'Metasploit::Cache::Post::Class'"
          taillabel = "belongs_to :post_ancestor,\nclass_name: 'Metasploit::Cache::Post::Ancestor'"
        ]
      }

      "Metasploit::Cache::Payload::Staged::Class" [
        label = "Metasploit::Cache::Payload::Staged::Class | mc_payload_staged_classes | reference_name | <rank_id>rank_id | <stage_payload_ancestor_id>stage_ancestor_id | <stager_payload_ancestor_id>stager_payload_ancestor_id"
      ]
      
      "Metasploit::Cache::Payload::Staged::Class":stage_payload_ancestor_id -> "Metasploit::Cache::Payload::Stage::Ancestor":id [
        headlabel = "has_many :staged_payload_classes,\nclass_name: 'Metasploit::Cache::Payload::Staged::Class'"
        taillabel = "belongs_to :stage_payload_ancestor,\nclass_name: 'Metasploit::Cache::Payload::Stage::Ancestor'"
      ]

      "Metasploit::Cache::Payload::Staged::Class":stager_payload_ancestor_id -> "Metasploit::Cache::Payload::Stager::Ancestor":id [
        headlabel = "has_many :staged_payload_classes,\nclass_name: 'Metasploit::Cache::Payload::Staged::Class'"
        taillabel = "belongs_to :stager_payload_ancestor,\nclass_name: 'Metasploit::Cache::Payload::Stager::Ancestor'"
      ]

      "Metasploit::Cache::Payload::Staged::Class":rank_id -> "Metasploit::Cache::Module::Rank":id [
        headlabel = "has_many :staged_payload_classes,\nclass_name: 'Metasploit::Cache::Payload::Staged::Class'"
        taillabel = "belongs_to :rank"
      ]
    }

    subgraph cluster_metasploit_cache_instance {
      label = "Metasploit::Cache::*::Instance"

      "Metasploit::Cache::Auxiliary::Instance" [
        label = "Metasploit::Cache::Auxiliary::Instance | mc_auxiliary_instances | <id>id | <auxiliary_class_id>auxiliary_class_id | <default_auxiliary_action_id>default_auxiliary_action_id | description | disclosed_on | license | name | stance"
      ]

      "Metasploit::Cache::Auxiliary::Instance":auxiliary_class_id -> "Metasploit::Cache::Auxiliary::Class":id [
        headlabel = "has_one :auxiliary_instance,\nclass_name: 'Metasploit::Cache::Auxiliary::Instance'"
        taillabel = "belongs :auxiliary_class,\nclass_name: 'Metasploit::Cache::Auxiliary::Class"
      ]

      "Metasploit::Cache::Auxiliary::Instance":default_auxiliary_action_id -> "Metasploit::Cache::Auxiliary::Action":id [
        taillabel = "belongs_to :default_auxiliary_action,\nclass_name: 'Metasploit::Cache::Auxiliary::Action'"
      ]
    }
  }
}