digraph "metasploit-cache" {
  graph [
    rankdir = "LR"
    ranksep = "20.0"
  ]
  node [
    shape = "record"
  ]

  subgraph cluster_common {
    label = "Common and Unchanged"

    "Metasploit::Cache::Module::Path" [
      label = "Metasploit::Cache::Module::Path | mc_module_paths | <id>id | gem | name | real_path"
    ]

    "Metasploit::Cache::Module::Rank" [
      label = "Metasploit::Cache::Module::Rank | mc_module_ranks | <id>id | name | number"
    ]
  }

  subgraph cluster_before {
    label = "Before"

    "Before/Metasploit::Cache::Module::Ancestor" [
      label = "Metasploit::Cache::Module::Ancestor | mc_module_ancestors | full_name | module_type | <parent_path_id>parent_path_id | payload_type | reference_name | real_path | real_path_modified_at | real_path_sha1_hex_digest"
    ]

    "Before/Metasploit::Cache::Module::Ancestor":parent_path_id -> "Metasploit::Cache::Module::Path":id [
      arrowhead = "crowodot"
      arrowtail = "teetee"
      dir = "both"
    ]

    "Before/Metasploit::Cache::Module::Class" [
      label = "Metasploit::Cache::Module::Class | mc_module_classes | <id>id | full_name | module_type | payload_type | <rank_id>rank_id | reference_name"
    ]

    "Before/Metasploit::Cache::Module::Class":rank_id -> "Metasploit::Cache::Module::Rank":id [
      arrowhead = "crowodot"
      arrowtail = "teetee"
      dir = "both"
    ]

    "Before/Metasploit::Cache::Module::Instance" [
       label = "Metasploit::Cache::Module::Instance | mc_module_instances | <id>id | <default_action_id>default_action_id | default_target_id | description | disclosed_on | license | <module_class_id>module_class_id | name | privileged | stance"
    ]

    "Before/Metasploit::Cache::Module::Instance":module_class_id -> "Before/Metasploit::Cache::Module::Class":id [
      arrowhead = "teeodot"
      arrowtail = "teetee"
      dir = "both"
    ]

    "Before/Metasploit::Cache::Module::Action" [
      label = "Metasploit::Cache::Module::Action | mc_module_actions | <id>id | <module_instance_id>module_instance_id | name"
    ]

    "Before/Metasploit::Cache::Module::Instance":default_action_id -> "Before/Metasploit::Cache::Module::Action":id [
      arrowhead = "teetee"
      arrowtail = "teetee"
      dir = "both"
    ]

    "Before/Metasploit::Cache::Module::Action":module_instance_id -> "Before/Metasploit::Cache::Module::Instance":id [
      arrowhead = "crowodot"
      arrowtail = "teetee"
      dir = "both"
    ]
  }

  subgraph cluster_type_sti {
    label = "module_type + payload_type STI"

    "Metasploit::Cache::Module::Action" [
      label = "Metasploit::Cache::Module::Action | mc_module_actions | <id>id | <module_instance_id>module_instance_id | <module_instance_type>module_instance_type | name"
    ]

    "Metasploit::Cache::Module::Action":module_instance_id, "Metasploit::Cache::Module::Action":module_instance_type -> "Metasploit::Cache::Auxiliary::Instance":id [
      arrowhead = "crowodot"
      arrowtail = "teetee"
      dir = "both"
    ]

    "Metasploit::Cache::Module::Architecture" [
      label = "Metasploit::Cache::Module::Architecture | mc_module_architectures | <architecture_id>architecture_id | <architecturable_id>architecturable_id | <architecturable_type>architecturable_type"
    ]

    "Metasploit::Cache::Module::Architecture":architecturable_id, "Metasploit::Cache::Module::Architecture":architecturable_type -> "Metasploit::Cache::Encoder::Instance":id, "Metasploit::Cache::Exploit::Target":id, "Metasploit::Cache::Nop::Instance":id [
      arrowhead = "crowtee"
      arrowtail = "teetee"
      dir = "both"
    ]

    "Metasploit::Cache::Module::Platform" [
      label = "Metasploit::Cache::Module::Platform | mc_module_platforms | <platformable_id>platformable_id | <platformable_type>platform_type | <platform_id>platform_id"
    ]

    "Metasploit::Cache::Module::Platform":platformable_id, "Metasploit::Cache::Module::Platform":platformable_type -> "Metasploit::Cache::Encoder::Instance":id, "Metasploit::Cache::Exploit::Target":id [
      arrowhead = "crowtee"
      arrowtail = "teetee"
      dir = "both"
    ]

    "Metasploit::Cache::Module::Reference" [
      label = "Metasploit::Cache::Module::Reference | mc_module_references | <module_instance_id>module_instance_id | <module_instance_type>module_instance_type | <module_reference_id>reference_id"
    ]
 
    "Metasploit::Cache::Module::Reference":module_instance_id, "Metasploit::Cache::Module::Reference":module_instance_type -> "Metasploit::Cache::Exploit::Instance":id_to_module_instance [
      arrowhead = "crowtee"
      arrowhead = "teetee"
      dir = "both"
    ]

    "Metasploit::Cache::Exploit::Target" [
      label = "Metasploit::Cache::Exploit::Target | mc_exploit_targets | <id>id | <exploit_instance_id>exploit_instance_id | index | name"
    ]

    "Metasploit::Cache::Exploit::Target":exploit_instance_id -> "Metasploit::Cache::Exploit::Instance":id_to_exploit_instance_id [
      arrowhead = "crowtee"
      arrowtail = "teetee"
      dir = "both"
    ]

    subgraph cluster_mc_module_ancestors {
      label = "Metasploit::Cache::Module::Ancestor STI"

      "Metasploit::Cache::Module::Ancestor" [
        label = "Metasploit::Cache::Module::Ancestor | mc_module_ancestors | id | <parent_path_id>parent_path_id | relative_path | real_path_modified_at | real_path_sha1_hex_digest | type = 'Metasploit::Cache::Auxiliary::Ancestor'"
        style = "dashed"
      ]

      "Metasploit::Cache::Module::Ancestor":parent_path_id -> "Metasploit::Cache::Module::Path":id [
        arrowhead = "crowodot"
        arrowtail = "teetee"
        dir = "both"
      ]

      "Metasploit::Cache::Auxiliary::Ancestor" [
        label = "Metasploit::Cache::Auxiliary::Ancestor | <id>id | type = 'Metasploit::Cache::Auxiliary::Ancestor'"
      ]

      "Metasploit::Cache::Auxiliary::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]

      "Metasploit::Cache::Encoder::Ancestor" [
        label = "Metasploit::Cache::Encoder::Ancestor | <id>id | type = 'Metasploit::Cache::Encoder::Ancestor'"
      ]

      "Metasploit::Cache::Encoder::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]

      "Metasploit::Cache::Exploit::Ancestor" [
        label = "Metasploit::Cache::Exploit::Ancestor | <id>id | type = 'Metasploit::Cache::Exploit::Ancestor"
      ]

      "Metasploit::Cache::Exploit::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]

      "Metasploit::Cache::Nop::Ancestor" [
        label = "Metasploit::Cache::Nop::Ancestor | <id>id | type = 'Metasploit::Cache::Nop::Ancestor'"
      ]

      "Metasploit::Cache::Nop::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]

      "Metasploit::Cache::Payload::Single::Ancestor" [
        label = "Metasploit::Cache::Payload::Single::Ancestor | <id>id | type = 'Metasploit::Cache::Payload::Single::Ancestor'"
      ]

      "Metasploit::Cache::Payload::Single::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]
      
      "Metasploit::Cache::Payload::Stage::Ancestor" [
        label = "Metasploit::Cache::Payload::Stage::Ancestor | <id_to_ancestor_id>id | <id_to_stage_payload_ancestor_id>id | type = 'Metasploit::Cache::Payload::Stage::Ancestor'"
      ]

      "Metasploit::Cache::Payload::Stage::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]
      
      "Metasploit::Cache::Payload::Stager::Ancestor" [
        label = "Metasploit::Cache::Payload::Stager::Ancestor | <id_to_ancestor_id>id | <id_to_stager_payload_ancestor_id>id | type = 'Metasploit::Cache::Payload::Stager::Ancestor'"
      ]

      "Metasploit::Cache::Payload::Stager::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]
      
      "Metasploit::Cache::Post::Ancestor" [
        label = "Metasploit::Cache::Post::Ancestor | <id>id | type = 'Metasploit::Cache::Post::Ancestor'"
      ]

      "Metasploit::Cache::Post::Ancestor" -> "Metasploit::Cache::Module::Ancestor" [
        label = "subclasses"
      ]
    }

    subgraph cluster_metasploit_cache_class {
      label = "Metasploit::Cache::*::Class"

      subgraph cluster_metasploit_cache_direct_class {
        label = "Metasploit::Cache::Direct::Class STI"

        "Metasploit::Cache::Direct::Class" [
          label = "Metasploit::Cache::Direct::Class | mc_direct_classes | <ancestor_id>ancestor_id | <rank_id>rank_id | type = 'Metasploit::Cache::Direct::Class'"
          style = "dashed"
        ]

        "Metasploit::Cache::Direct::Class":rank_id -> "Metasploit::Cache::Module::Rank":id [
          arrowhead = "crowodot"
          arrowtail = "teetee"
          dir = "both"
        ]

        "Metasploit::Cache::Auxiliary::Class" [
          label = "Metasploit::Cache::Auxiliary::Class | <id>id | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Auxiliary::Class'"
        ]

        "Metasploit::Cache::Auxiliary::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Auxiliary::Class":ancestor_id -> "Metasploit::Cache::Auxiliary::Ancestor":id [
          arrowhead = "teeodot"
          arrowtail = "teetee"
          dir = "both"
        ]
        
        "Metasploit::Cache::Encoder::Class" [
          label = "Metasploit::Cache::Encoder::Class | <id>id | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Encoder::Class'"
        ]

        "Metasploit::Cache::Encoder::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Encoder::Class":ancestor_id -> "Metasploit::Cache::Encoder::Ancestor":id [
          arrowhead = "teeodot"
          arrowtail = "teetee"
          dir = "both"
        ]
                
        "Metasploit::Cache::Exploit::Class" [
          label = "Metasploit::Cache::Exploit::Class | <id>id | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Exploit::Class'"
        ]

        "Metasploit::Cache::Exploit::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Exploit::Class":ancestor_id -> "Metasploit::Cache::Exploit::Ancestor":id [
          arrowhead = "teeodot"
          arrowtail = "teetee"
          dir = "both"
        ]
        
        "Metasploit::Cache::Nop::Class" [
          label = "Metasploit::Cache::Nop::Class | <id>id | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Nop::Class'"
        ]

        "Metasploit::Cache::Nop::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Nop::Class":ancestor_id -> "Metasploit::Cache::Nop::Ancestor":id [
          arrowhead = "teeodot"
          arrowtail = "teetee"
          dir = "both"
        ]
        
        "Metasploit::Cache::Payload::Single::Class" [
          label = "Metasploit::Cache::Payload::Single::Class | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Payload::Single::Class'"
        ]

        "Metasploit::Cache::Payload::Single::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Payload::Single::Class":ancestor_id -> "Metasploit::Cache::Payload::Single::Ancestor":id [
          arrowhead = "teeodot"
          arrowtail = "teetee"
          dir = "both"
        ]
        
        "Metasploit::Cache::Payload::Stage::Class" [
          label = "Metasploit::Cache::Payload::Stage::Class | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Payload::Stage::Class'"
        ]

        "Metasploit::Cache::Payload::Stage::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Payload::Stage::Class":ancestor_id -> "Metasploit::Cache::Payload::Stage::Ancestor":id_to_ancestor_id [
          arrowhead = "teeodot"
          arrowtail = "teetee"
          dir = "both"
        ]
        
                
        "Metasploit::Cache::Payload::Stager::Class" [
          label = "Metasploit::Cache::Payload::Stager::Class | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Payload::Stager::Class'"
        ]

        "Metasploit::Cache::Payload::Stager::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Payload::Stager::Class":ancestor_id -> "Metasploit::Cache::Payload::Stager::Ancestor":id_to_ancestor_id [
          arrowhead = "teeodot"
          arrowtail = "teetee"
          dir = "both"
        ]
        
        "Metasploit::Cache::Post::Class" [
          label = "Metasploit::Cache::Post::Class | <ancestor_id>ancestor_id | type = 'Metasploit::Cache::Post::Class'"
        ]

        "Metasploit::Cache::Post::Class" -> "Metasploit::Cache::Direct::Class" [
          label = "subclasses"
        ]

        "Metasploit::Cache::Post::Class":ancestor_id -> "Metasploit::Cache::Post::Ancestor":id [
          arrowhead = "teeodot"
          arrowtail = "teetee"
          dir = "both"
        ]
      }

      "Metasploit::Cache::Payload::Staged::Class" [
        label = "Metasploit::Cache::Payload::Staged::Class | mc_payload_staged_classes | reference_name | <rank_id>rank_id | <stage_payload_ancestor_id>stage_ancestor_id | <stager_payload_ancestor_id>stager_payload_ancestor_id"
      ]
      
      "Metasploit::Cache::Payload::Staged::Class":stage_payload_ancestor_id -> "Metasploit::Cache::Payload::Stage::Ancestor":id_to_stage_payload_ancestor_id [
        arrowhead = "crowodot"
        arrowtail = "teetee"
        dir = "both"
      ]

      "Metasploit::Cache::Payload::Staged::Class":stager_payload_ancestor_id -> "Metasploit::Cache::Payload::Stager::Ancestor":id_to_stager_payload_ancestor_id [
          arrowhead = "crowodot"
          arrowtail = "teetee"
          dir = "both"
      ]

      "Metasploit::Cache::Payload::Staged::Class":rank_id -> "Metasploit::Cache::Module::Rank":id [
          arrowhead = "crowodot"
          arrowtail = "teetee"
          dir = "both"
      ]
    }

    subgraph cluster_metasploit_cache_instance {
      label = "Metasploit::Cache::*::Instance"

      "Metasploit::Cache::Auxiliary::Instance" [
        label = "Metasploit::Cache::Auxiliary::Instance | mc_auxiliary_instances | <id>id | <auxiliary_class_id>auxiliary_class_id | <default_module_action_id>default_module_action_id | description | disclosed_on | license | name | stance"
      ]

      "Metasploit::Cache::Auxiliary::Instance":auxiliary_class_id -> "Metasploit::Cache::Auxiliary::Class":id [
        arrowhead = "teeodot"
        arrowtail = "teetee"
        dir = "both"
      ]

      "Metasploit::Cache::Auxiliary::Instance":default_module_action_id -> "Metasploit::Cache::Module::Action":id [
        arrowhead = "teeodot"
        arrowtail = "teetee"
        dir = "both"
      ]

      "Metasploit::Cache::Encoder::Instance" [
        label = "Metasploit::Cache::Encoder::Instance | mc_encoder_instances | <id>id | description | disclosed_on | <encoder_class_id>encoder_class_id | license | name"
      ]

      "Metasploit::Cache::Encoder::Instance":encoder_class_id -> "Metasploit::Cache::Encoder::Class":id [
        arrowhead = "teeodot"
        arrowtail = "teetee"
        dir = "both"
      ]

      "Metasploit::Cache::Exploit::Instance" [
        label = "Metasploit::Cache::Exploit::Instance | mc_exploit_instances | <id_to_module_instance>id | <id_to_exploit_instance_id>id | <default_target_id>default_target_id | description | disclosed_on | <exploit_class_id>exploit_class_id | license | name | privileged | stance"
      ]

      "Metasploit::Cache::Exploit::Instance":default_target_id -> "Metasploit::Cache::Exploit::Target":id [
        arrowhead = "teeodot"
        arrowtail = "teetee"
        dir = "both"
      ]
      
      "Metasploit::Cache::Exploit::Instance":exploit_class_id -> "Metasploit::Cache::Exploit::Class":id [
        arrowhead = "teeodot"
        arrowtail = "teetee"
        dir = "both"
      ]

      "Metasploit::Cache::Nop::Instance" [
        label = "Metasploit::Cache::Nop::Instance | mc_nop_instances | <id>id | description | disclosed_on | license | <nop_class_id>nop_class_id | name"
      ]

      "Metasploit::Cache::Nop::Instance":nop_class_id -> "Metasploit::Cache::Nop::Class":id [
        arrowhead = "teeodot"
        arrowtail = "teetee"
        dir = "both"
      ]
    }
  }
}