require 'cell/twin'

# Cell for rendering {Metasploit::Cache::Exploit::Instance#exploit_class}
# {Metasploit::Cache::Direct::Class#ancestor} {Metasploit::Cache::Module::Ancestor#contents}.
#
# In addition to content from {Metasploit::Cache::Module::AncestorCell} and
# {Metasploit::Cache::Direct::Class::AncestorCell}, it also includes `#authors` for
# {Metasploit::Cache::Exploit::Instance#contributions}, `#default_target` for
# {Metasploit::Cache::Exploit::Instance#default_exploit_target} {Metasploit::Cache::Exploit:Target#index},
# `#description` for {Metasploit::Cache::Exploit::Instance#description}, `#license` for
# {Metasploit::Cache::Exploit::Instance#licensable_licenses} {Metasploit::Cache::Licensable::Licenses#license}s,
# `#name` for {Metasploit::Cache::Exploit::Instance#name}, and `#targets` for
# {Metasploit::Cache::Exploit::Instance#exploit_targets}.
class Metasploit::Cache::Exploit::Instance::ExploitClass::AncestorCell < Cell::ViewModel
  include Metasploit::Cache::AncestorCell

  #
  # Properties
  #

  property :contributions
  property :default_exploit_target
  property :description
  property :disclosed_on
  property :exploit_class
  property :exploit_targets
  property :licensable_licenses
  property :name
  property :privileged
  property :referencable_references
  property :stance

  #
  # Instance Methods
  #

  def show(metasploit_class_relative_name:, superclass:)
    render locals: {
               metasploit_class_relative_name: metasploit_class_relative_name,
               superclass: superclass
           }
  end
end
